<!DOCTYPE html>
{% load get2_extras %}
{% load staticfiles %}
<html lang="en">
<head>
    <title>Domestic flight</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{% static 'search/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'search/font-awesome.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'search/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'search/fonts.css' %}">
    <script src="{% static 'search/js/jquery-1.12.4.js' %}"></script>
    <script src="{% static 'search/js/bootstrap.min.js' %}"></script>
</head>
<body>
<header>
    <nav class="navbar navbar-default navbar-fixed-top menubar">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="fa fa-bars fa-2x"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <img src="{% static 'search/images/can.png' %}" alt="logo hình lá cần">
                    <span class="span-header-for-middle">Get Hi Travel</span>
                </a>
            </div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav navbar-right text-uppercase my-nav-text-style">
                    <li><a id="a-domestic-page" title="Các chuyến bay nội địa" href="{% url 'search:domestic' %}">Domestic</a>
                    </li>
                    <li><a id="a-internal-page" href="{% url 'search:insert_db_ticket' %}">Insert</a></li>
                    <li><a id="a-ud-routes" title="Update the routes"
                           href="{% url 'search:update_routes' %}">Upgrade</a></li>
                    <li><a id="a-del-page" title="Delete all ticket" href="{% url 'search:delete' %}">Delete</a></li>
                    <li><a id="a-about-page" title="Trang About" href="{% url 'search:about' %}">About</a></li>
                    <li><a id="a-contact-page" title="Trang Contact" href="{% url 'search:contact' %}">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<div class="container main">
    <!-- form se duoc gui thong qua ajax -->
    <form id="myForm" method="get" action="">
        <div class="row">
            <div class="group-item col-xs-12 col-sm-4">
                <div class="title-col col-xs-12">
                    <span class="number">1</span>
                    <span class="title">Hành trình bay</span>
                </div>
                <div class="form-group col-xs-12">
                    <label class="control-label" for="from">Điểm khởi hành:</label>
                    <select name="departure" id="from" class="form-control" required>
                        <option class="pickFlightStart" value="" style="text-align: center">-- Vui lòng chọn địa điểm
                            --
                        </option>
                        <option class="pickFlightStart" value="BMV"> Buôn Ma Thuột (BMV)</option>
                        <option class="pickFlightStart" value="DAD"> Đà Nẵng (DAD)</option>
                        <option class="pickFlightStart" value="DLI"> Đà Lạt (DLI)</option>
                        <option class="pickFlightStart" value="DIN"> Điện Biên Phủ (DIN)</option>
                        <option class="pickFlightStart" value="HPH"> Hải Phòng (HPH)</option>
                        <option class="pickFlightStart" value="HAN"> Hà Nội (HAN)</option>
                        <option class="pickFlightStart" value="SGN"> Hồ Chí Minh (SGN)</option>
                        <option class="pickFlightStart" value="HUI"> Huế (HUI)</option>
                        <option class="pickFlightStart" value="CXR"> Nha Trang (CXR)</option>
                        <option class="pickFlightStart" value="PQC"> Phú Quốc (PQC)</option>
                        <option class="pickFlightStart" value="PXU"> Pleiku (PXU)</option>
                        <option class="pickFlightStart" value="UIH"> Qui Nhơn (UIH)</option>
                        <option class="pickFlightStart" value="VKG"> Rạch Giá (VKG)</option>
                        <option class="pickFlightStart" value="VII"> Vinh (VII)</option>
                        <option class="pickFlightStart" value="TBB"> Tuy Hòa (TBB)</option>
                        <option class="pickFlightStart" value="VCL"> Chu Lai (VCL)</option>
                        <option class="pickFlightStart" value="VDH"> Đồng Hới (VDH)</option>
                        <option class="pickFlightStart" value="VCS"> Côn Đảo (VCS)</option>
                        <option class="pickFlightStart" value="THD"> Thanh Hóa (THD)</option>
                        <option class="pickFlightStart" value="VCA"> Cần Thơ (VCA)</option>
                        <option class="pickFlightStart" value="CAH"> Cà Mau (CAH)</option>
                    </select>
                </div>
                <div class="form-group col-xs-12">
                    <label class="control-label" for="to">Điểm đến:</label>
                    <select name="arrival" id="to" class="form-control" required>
                        <option class="pickFlightStart" value="" style="text-align: center">-- Vui lòng chọn địa điểm
                            --
                        </option>
                        <option class="pickFlightStart" value="BMV"> Buôn Ma Thuột (BMV)</option>
                        <option class="pickFlightStart" value="DAD"> Đà Nẵng (DAD)</option>
                        <option class="pickFlightStart" value="DLI"> Đà Lạt (DLI)</option>
                        <option class="pickFlightStart" value="DIN"> Điện Biên Phủ (DIN)</option>
                        <option class="pickFlightStart" value="HPH"> Hải Phòng (HPH)</option>
                        <option class="pickFlightStart" value="HAN"> Hà Nội (HAN)</option>
                        <option class="pickFlightStart" value="SGN"> Hồ Chí Minh (SGN)</option>
                        <option class="pickFlightStart" value="HUI"> Huế (HUI)</option>
                        <option class="pickFlightStart" value="CXR"> Nha Trang (CXR)</option>
                        <option class="pickFlightStart" value="PQC"> Phú Quốc (PQC)</option>
                        <option class="pickFlightStart" value="PXU"> Pleiku (PXU)</option>
                        <option class="pickFlightStart" value="UIH"> Qui Nhơn (UIH)</option>
                        <option class="pickFlightStart" value="VKG"> Rạch Giá (VKG)</option>
                        <option class="pickFlightStart" value="VII"> Vinh (VII)</option>
                        <option class="pickFlightStart" value="TBB"> Tuy Hòa (TBB)</option>
                        <option class="pickFlightStart" value="VCL"> Chu Lai (VCL)</option>
                        <option class="pickFlightStart" value="VDH"> Đồng Hới (VDH)</option>
                        <option class="pickFlightStart" value="VCS"> Côn Đảo (VCS)</option>
                        <option class="pickFlightStart" value="THD"> Thanh Hóa (THD)</option>
                        <option class="pickFlightStart" value="VCA"> Cần Thơ (VCA)</option>
                        <option class="pickFlightStart" value="CAH"> Cà Mau (CAH)</option>
                    </select>
                </div>
                <div class="form-group col-xs-12 hidden">
                    <label class="control-label" for="stops">Chặng dừng:</label>
                    <select class="form-control" id="stops" name="stops">
                        <option value="0">Bất kỳ</option>
                        <option value="1">Không trung chuyển</option>
                        <option value="2">Một điểm dừng</option>
                    </select>
                </div>
            </div>
            <div class="group-item col-xs-12 col-sm-4">
                <div class="title-col col-xs-12">
                    <span class="number">2</span>
                    <span class="title">Thời gian bay</span>
                </div>
                <div class="form-group col-xs-12">
                    <label class="control-label" for="outbound">Ngày đi:</label>
                    <input type="date" class="form-control" id="outbound" name="go_day" placeholder="Date...">
                </div>
                <div class="form-group col-xs-12" id="way">
                    <label class="radio-inline"><input type="radio" name="way" value="1" checked>Một chiều</label>
                    <label class="radio-inline"><input type="radio" name="way" value="2">Khứ hồi</label>
                </div>
                <div class="form-group col-xs-12" id="inbound">
                    <label class="control-label" for="return">Ngày về:</label>
                    <input type="date" class="form-control" id="return" name="rt_day" placeholder="Date...">
                </div>
            </div>
            <div class="group-item col-xs-12 col-sm-4">
                <div class="title-col col-xs-12">
                    <span class="number">3</span>
                    <span class="title">Số hành khách</span>
                </div>
                <div class="form-group input-inline col-xs-4">
                    <label class="control-label" for="adult"><img src="{% static 'search/images/adult.jpg' %}" title="Adult"
                                                                  alt="icon"></label>
                    <select class="form-control" id="adult" name="adult">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                    </select>
                </div>
                <div class="form-group input-inline col-xs-4">
                    <label class="control-label" for="child"><img src="{% static 'search/images/child.jpg' %}" title="Child"
                                                                  alt="icon"></label>
                    <select class="form-control" id="child" name="child">
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                    </select>
                </div>
                <div class="form-group input-inline col-xs-4">
                    <label class="control-label" for="babe"><img src="{% static 'search/images/babe.jpg' %}" title="Babe" alt="icon"></label>
                    <select class="form-control" id="babe" name="babe">
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
                <div class="form-group col-xs-12 hidden">
                    <label class="control-label" for="type-ticket">Loại vé</label>
                    <select class="form-control" id="type-ticket" name="ttype">
                        <option value="all">Bất kì</option>
                        <option value="save">Giá rẻ</option>
                        <option value="economy">Phổ thông</option>
                        <option value="business">Thương gia</option>
                        <option value="first">Hạng nhất</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row center-block text-center">
            {% csrf_token %}
            <button type="submit" class="btn btn-success btn-search" id="search" name="search">Tìm chuyến bay</button>
        </div>
    </form>
    <div id="result">
        {% if outward_list %}
            <table class="table-result-layout">
            <tbody>
            {% for flight in outward_list %}
                <tr>
                    <td>
                        <table id="{{ flight.first_flight.flight_code}}_1" class="table-result">
                            <colgroup span="5">
                                <col width="18%">
                                <col width="10%">
                                <col width="40%">
                                <col width="20%">
                                <col width="12%">
                            </colgroup>
                            <tbody>
                            <tr class="a-result-flight">
                                <td class="result-time">
                                    {{ flight.departure_time.time|time:"g:iA"|lower }}
                                    &rarr;
                                    {{ flight.arrival_time.time|time:"g:iA"|lower }}
                                </td>
                                <td class="result-carrier">
                                    {{ flight.first_flight.carrier|carrier }}<br>
                                    {{ flight.first_flight.flight_code }}
                                </td>
                                <td class="result-transit">
                                    {% if not flight.transit %}
                                        Bay trực tiếp <br>
                                        {{ flight.first_flight.departure_name }}
                                        &rarr;
                                        {{ flight.first_flight.arrival_name }}
                                    {% else %}
                                        Có trung chuyển <br>
                                        {{ flight.first_flight.departure_name }}
                                        &rarr;
                                        {{ flight.transit }}
                                        &rarr;
                                        {{ flight.end_port }}
                                    {% endif %}
                                </td>
                                <td class="result-price">
                                    {{ flight.total_price }}
                                </td>
                                <td class="result-button">
                                    <button class="btn btn-success" id="{{ flight.first_flight.flight_code}}_1">Xem</button>
                                </td>
                            </tr>
                            <tr class="result-detail hidden" id="detail_{{ flight.first_flight.flight_code }}_1">
                                <td colspan="5">
                                    <ul>
                                        {% for ticket in flight.first_flight.seat_list %}
                                            <li>{{ ticket.ticket_type|ticket_type }} : {{ ticket.total_price }}</li>
                                        {% endfor %}
                                    </ul>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
            </table>
        {% endif %}
    </div>
{% comment %}
    <div id="result">
        {% if item_list and quan %}
        <p class="rs-title">Kết quả</p>
        <div class="rs-div-group">
            {% if rs_type %}
            <div>{{ item_list }}</div>
            {% else %}
            <p><strong>Chiều đi: {{ places.dep }} đi {{ places.arr }} | {{ dates.go }}</strong></p>
            <div class="rs-div-result">
                <table class="ticket-list-table">
                    <tr class="tr-tik-header">
                        <th class="th-time-come">Mã chuyến bay</th>
                        <th class="th-time-go">Giờ đi</th>
                        <th class="th-time-come">Giờ đến</th>
                        <th class="th-time-come">Hãng</th>
                        <th class="th-ticket-type">Loại vé</th>
                        <th class="price">Giá (1000 VND)</th>
                        <th class="th-place">Đặt vé</th>
                    </tr>
                    {% for ticket in item_list %}
                    <tr class="tr-tik">
                        <td>{{ ticket.flight_code}}</td>
                        <td>{{ ticket.departure_time.time }}</td>
                        <td>{{ ticket.arrival_time.time }}</td>
                        <td>{{ ticket.carrier|carrier }}</td>
                        <td>{{ ticket.sit_class|clat}}</td>
                        <td>{% price quan ticket.price_adult ticket.price_child ticket.price_babe ticket.fee_tax_adult ticket.fee_tax_child ticket.fee_tax_babe %}
                        </td>
                        <td><a href="javascript:void(0)">Đặt vé</a></td>
                    </tr>
                    {% endfor %}
                </table>

            </div>
            {% endif %}
            {% if rt_list %}
            <p></p>
            <p><strong>Chiều về: {{ places.arr }} về {{ places.dep }} | {{ dates.back }}</strong></p>
            <div class="rs-div-result">
                <table class="ticket-list-table">
                    <tr class="tr-tik-header">
                        <th class="th-time-come">Mã chuyến bay</th>
                        <th class="th-time-go">Giờ đi</th>
                        <th class="th-time-come">Giờ đến</th>
                        <th class="th-time-come">Hãng</th>
                        <th class="th-ticket-type">Loại vé</th>
                        <th class="price">Giá (1000 VND)</th>
                        <th class="th-place">Đặt vé</th>
                    </tr>
                    {% for rt in rt_list %}
                    <tr class="tr-tik">
                        <td>{{ rt.flight_code}}</td>
                        <td>{{ rt.departure_time.time }}</td>
                        <td>{{ rt.arrival_time.time }}</td>
                        <td>{{ rt.carrier|carrier }}</td>
                        <td>{{ rt.sit_class|clat}}</td>
                        <td>{% price quan rt.price_adult rt.price_child rt.price_babe rt.fee_tax_adult rt.fee_tax_child rt.fee_tax_babe %}
                        </td>
                        <td><a href="javascript:void(0)">Đặt vé</a></td>
                    </tr>
                    {% endfor %}
                </table>

            </div>
            {% endif %}
        </div>
        {% else %}
        {% if return_msg %}
        <p>{{ return_msg }}</p>
        {% else %}
        <p>Hãy bắt đầu tìm kiếm để có được kết quả</p>
        {% endif %}
        {% endif %}
    </div>
{% endcomment %}

</div>
<footer class="container-fluid text-center footer-my-style">
    <p>Get Hi Travel pleasure for serve you. Have a good day and a nice travel</p>
</footer>
<script type="text/javascript">
    $(document).ready(function () {
        {% if sform %}
            $('#from').val('{{ sform.departure }}');
            $('#to').val('{{ sform.arrival }}');
            $('#way').val('{{ sform.way }}');
            if ($('#way').val() == '2'){
                rt_show();
            }
            $('#stops').val('{{ sform.stop }}');
            var go_d = new Date('{{ sform.go_day }}');
            makeday(go_d, '#outbound');
            var rt_d = new Date('{{ sform.rt_day }}');
            makeday(rt_d, '#return');
            $('#type-ticket').val('{{ sform.ttype }}');
            $('#adult').val('{{ quan.adult }}');
            $('#child').val('{{ quan.child }}');
            $('#babe').val('{{ quan.babe }}');
        {% else %}
            test();
            rt_day();
        {% endif %}
    });









</script>
<script src="{% static 'search/js/main.js' %}"></script>
</body>
</html>