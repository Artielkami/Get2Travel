<!DOCTYPE html>
{% load get2_extras %}
<html lang="en">
<head>
    <title>Domestic flight</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../../static/search/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</head>
<body>
<header>
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="fa fa-bars fa-2x"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <img src="../../static/search/images/can.png" alt="logo hình lá cần">
                    <span class="span-header-for-middle">Get Hi Travel</span>
                </a>
            </div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav navbar-right text-uppercase my-nav-text-style">
                    <li><a id="a-domestic-page" title="Các chuyến bay nội địa" href="{% url 'search:domestic' %}">Domestic</a></li>
{#                    <li><a id="a-internal-page" href="{% url 'search:insert_db_ticket' %}">International</a></li>#}
{#                    <li><a id="a-ud-routes" title="Update the routes" href="{% url 'search:update_routes' %}">Upgrade</a></li>#}
{#                    <li><a id="a-del-page" title="Delete all ticket" href="{% url 'search:delete' %}">Delete</a></li>#}
                    <li><a id="a-about-page" title="Trang About" href="{% url 'search:about' %}">About</a></li>
                    <li><a id="a-contact-page" title="Trang Contact" href="{% url 'search:contact' %}">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<div class="container main">
    <!-- form se duoc gui thong qua ajax -->
    <form id="myForm" method="get" action="">
        <div class="row">
            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4">
                <label class="control-label" for="from">From:</label>
                <!--<input type="text" class="form-control" id="from" name="from" placeholder="Location...">-->
                <select name="departure" id="from" class="form-control">
                    <option class="pickFlightStart" value="" style="text-align: center">-- Please choose place --</option>
                    <option class="pickFlightStart" value="BMV"> Buôn Ma Thuột (BMV)</option>
                    <option class="pickFlightStart" value="DAD"> Đà Nẵng (DAD)</option>
                    <option class="pickFlightStart" value="DLI"> Đà Lạt (DLI)</option>
                    <option class="pickFlightStart" value="DIN"> Điện Biên Phủ (DIN)</option>
                    <option class="pickFlightStart" value="HPH"> Hải Phòng (HPH)</option>
                    <option class="pickFlightStart" value="HAN"> Hà Nội (HAN)</option>
                    <option class="pickFlightStart" value="SGN"> Hồ Chí Minh (SGN)</option>
                    <option class="pickFlightStart" value="HUI"> Huế (HUI)</option>
                    <option class="pickFlightStart" value="CXR"> Nha Trang (CXR)</option>
                    <option class="pickFlightStart" value="PQC"> Phú Quốc (PQC)</option>
                    <option class="pickFlightStart" value="PXU"> Pleiku (PXU)</option>
                    <option class="pickFlightStart" value="UIH"> Qui Nhơn (UIH)</option>
                    <option class="pickFlightStart" value="VKG"> Rạch Giá (VKG)</option>
                    <option class="pickFlightStart" value="VII"> Vinh (VII)</option>
                    <option class="pickFlightStart" value="TBB"> Tuy Hòa (TBB)</option>
                    <option class="pickFlightStart" value="VCL"> Chu Lai (VCL)</option>
                    <option class="pickFlightStart" value="VDH"> Đồng Hới (VDH)</option>
                    <option class="pickFlightStart" value="VCS"> Côn Đảo (VCS)</option>
                    <option class="pickFlightStart" value="THD"> Thanh Hóa (THD)</option>
                    <option class="pickFlightStart" value="VCA"> Cần Thơ (VCA)</option>
                    <option class="pickFlightStart" value="CAH"> Cà Mau (CAH)</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4">
                <label class="control-label" for="to">To:</label>
                <!--<input type="text" class="form-control" id="to" name="to" placeholder="Location...">-->
                <select name="arrival" id="to" class="form-control">
                    <option class="pickFlightStart" value="" style="text-align: center">-- Please choose place --</option>
                    <option class="pickFlightStart" value="BMV"> Buôn Ma Thuột (BMV)</option>
                    <option class="pickFlightStart" value="DAD"> Đà Nẵng (DAD)</option>
                    <option class="pickFlightStart" value="DLI"> Đà Lạt (DLI)</option>
                    <option class="pickFlightStart" value="DIN"> Điện Biên Phủ (DIN)</option>
                    <option class="pickFlightStart" value="HPH"> Hải Phòng (HPH)</option>
                    <option class="pickFlightStart" value="HAN"> Hà Nội (HAN)</option>
                    <option class="pickFlightStart" value="SGN"> Hồ Chí Minh (SGN)</option>
                    <option class="pickFlightStart" value="HUI"> Huế (HUI)</option>
                    <option class="pickFlightStart" value="CXR"> Nha Trang (CXR)</option>
                    <option class="pickFlightStart" value="PQC"> Phú Quốc (PQC)</option>
                    <option class="pickFlightStart" value="PXU"> Pleiku (PXU)</option>
                    <option class="pickFlightStart" value="UIH"> Qui Nhơn (UIH)</option>
                    <option class="pickFlightStart" value="VKG"> Rạch Giá (VKG)</option>
                    <option class="pickFlightStart" value="VII"> Vinh (VII)</option>
                    <option class="pickFlightStart" value="TBB"> Tuy Hòa (TBB)</option>
                    <option class="pickFlightStart" value="VCL"> Chu Lai (VCL)</option>
                    <option class="pickFlightStart" value="VDH"> Đồng Hới (VDH)</option>
                    <option class="pickFlightStart" value="VCS"> Côn Đảo (VCS)</option>
                    <option class="pickFlightStart" value="THD"> Thanh Hóa (THD)</option>
                    <option class="pickFlightStart" value="VCA"> Cần Thơ (VCA)</option>
                    <option class="pickFlightStart" value="CAH"> Cà Mau (CAH)</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4" id="div-way">
                <label class="control-label" for="way">Way:</label>
                <select class="form-control" id="way" name="way" onchange="rt_show()">
                    <option value="1">One Way (Một chiều)</option>
                    <option value="2">Round Trip (Khứ rồi)</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4">
                <label class="control-label" for="stops">Stops:</label>
                <select class="form-control" id="stops" name="stops">
                    <option value="0">Any</option>
                    <option value="1">Nonstop</option>
                    <option value="2">Up to 1 stop</option>
                </select>
            </div>

            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4">
                <label class="control-label" for="outbound">Outbound time:</label>
                <input type="date" class="form-control" id="outbound" name="go_day" placeholder="Date...">
            </div>
            <div class="form-group col-xs-12 col-sm-4 col-md-4 col-lg-4" id="div-return">
                <label class="control-label" for="return">Return time:</label>
                <input type="date" class="form-control" id="return" name="rt_day" placeholder="Date...">
            </div>

            <div class="form-group col-xs-12 col-sm-3 col-md-3 col-lg-3">
                <label class="control-label" for="type-ticket">Loại vé</label>
                <select class="form-control" id="type-ticket" name="ttype">
                    <option value="all">Bất kì</option>
                    <option value="save">Giá rẻ</option>
                    <option value="economy">Phổ thông</option>
                    <option value="business">Thương gia</option>
                    <option value="first">Hạng nhất</option>
                </select>
            </div>

            <div class="form-group col-xs-12 col-sm-3 col-md-3 col-lg-3">
                <label class="control-label" for="adult">Adult: (> 12 years old)</label>
                <select class="form-control" id="adult" name="adult">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-sm-3 col-md-3 col-lg-3">
                <label class="control-label" for="child">Child: (2 - 12 years old)</label>
                <select class="form-control" id="child" name="child">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-sm-3 col-md-3 col-lg-3">
                <label class="control-label" for="babe">Babe: (< 2 years old)</label>
                <select class="form-control" id="babe" name="babe">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </div>
        </div>
        <div class="row center-block text-center">
            {% csrf_token %}
            <button type="submit" class="btn btn-success btn-my-search-style" id="search" name="search">Search</button>
        </div>
    </form>
    <div id="result">
        {% if item_list and quan %}
        <p class="rs-title">Kết quả</p>
        <div class="rs-div-group">

            <p><strong>Chiều đi: từ {{ places.dep }} đi {{ places.arr }}, {{ dates.go }}</strong></p>
            <div class="rs-div-result">
                <table class="ticket-list-table">
                    <tr class="tr-tik-header">
                        <th class="th-time-come">Mã chuyến bay</th>
                        <th class="th-time-go">Giờ đi</th>
                        <th class="th-time-come">Giờ đến</th>
                        <th class="th-time-come">Hãng</th>
                        <th class="th-ticket-type">Loại vé</th>
                        <th class="price">Giá (1000 VND)</th>
                        <th class="th-place">Đặt vé</th>
                    </tr>
                    {% for ticket in item_list %}
                    <tr class="tr-tik">
                        <td>{{ ticket.flight_code}}</td>
                        <td>{{ ticket.departure_time.time }}</td>
                        <td>{{ ticket.arrival_time.time }}</td>
                        <td>{{ ticket.carrier }}</td>
                        <td>{{ ticket.sit_class|clat}}</td>
                        <td>{% price quan ticket.price_adult ticket.price_child ticket.price_babe ticket.fee_tax_adult ticket.fee_tax_child ticket.fee_tax_babe %}</td>
                        <td><a href="javascript:void(0)">Đặt vé</a></td>
                    </tr>
                    {% endfor %}
                </table>

            </div>

            {% if rt_list %}
                <p></p>
                <p><strong>Chiều về: từ {{ places.arr }} về {{ places.dep }} {{ dates.back }}</strong></p>
                <div class="rs-div-result">
                <table class="ticket-list-table">
                    <tr class="tr-tik-header">
                        <th class="th-time-come">Mã chuyến bay</th>
                        <th class="th-time-go">Giờ đi</th>
                        <th class="th-time-come">Giờ đến</th>
                        <th class="th-time-come">Hãng</th>
                        <th class="th-ticket-type">Loại vé</th>
                        <th class="price">Giá (1000 VND)</th>
                        <th class="th-place">Đặt vé</th>
                    </tr>
                    {% for rt in rt_list %}
                    <tr class="tr-tik">
                        <td>{{ rt.flight_code}}</td>
                        <td>{{ rt.departure_time.time }}</td>
                        <td>{{ rt.arrival_time.time }}</td>
                        <td>{{ rt.carrier }}</td>
                        <td>{{ rt.sit_class|clat}}</td>
                        <td>{% price quan rt.price_adult rt.price_child rt.price_babe rt.fee_tax_adult rt.fee_tax_child rt.fee_tax_babe %}</td>
                        <td><a href="javascript:void(0)">Đặt vé</a></td>
                    </tr>
                    {% endfor %}
                </table>

            </div>
            {% endif %}
        </div>
        {% else %}
            {% if return_msg %}
                <p>{{ return_msg }}</p>
            {% else %}
            <p>Hãy bắt đầu tìm kiếm để có được kết quả</p>
            {% endif %}
        {% endif %}
    </div>
</div>
<footer class="container-fluid text-center footer-my-style">
    <p>Get Hi Travel pleasure for serve you. Have a good day and a nice travel</p>
</footer>
<script type="text/javascript">
    $(document).ready(function () {
        test();
        rt_day();
    });
    function rt_show() {
        if($('#way').val() == '1'){
            $('#div-return').css('visibility', 'hidden');
        } else {
            $('#div-return').css('visibility', 'visible');
        }
    }
    function rt_day() {
        var d = new Date();
        d.setDate(3);
        var day = d.getDate();
        var year = d.getYear() + 1900;
        var mon = d.getMonth() + 1;
        if(day == 1 || day == 2 || day == 3){
            mon += 1;
        }
        var time;
        if (day < 10 && mon < 10) {
            time = year + '-0' + mon + '-0' + day;
            $('#return').val(time);
            return false;
        }
        else if (day < 10 && mon > 10) {
            time = year + '-' + mon + '-0' + day;
            $('#return').val(time);
            return false;
        }
        else if (day > 10 && mon < 10) {
            time = year + '-0' + mon + '-' + day;
            $('#return').val(time);
            return false;
        }
        else {
            time = year + '-' + mon + '-' + day;
            $('#return').val(time);
            return false;
        }
    }
    function test() {
        var d = new Date();
        var day = d.getDate() + 1;
        var year = d.getYear() + 1900;
        var mon = d.getMonth() + 1;
        var time;
        if (day < 10 && mon < 10) {
            time = year + '-0' + mon + '-0' + day;
            $('#outbound').val(time);
            return false;
        }
        else if (day < 10 && mon > 10) {
            time = year + '-' + mon + '-0' + day;
            $('#outbound').val(time);
            return false;
        }
        else if (day > 10 && mon < 10) {
            time = year + '-0' + mon + '-' + day;
            $('#outbound').val(time);
            return false;
        }
        else {
            time = year + '-' + mon + '-' + day;
            $('#outbound').val(time);
            return false;
        }
    }
</script>
</body>
</html>